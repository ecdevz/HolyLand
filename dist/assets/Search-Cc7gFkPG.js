import{_ as g,i as p,k as m,c as i,a as e,h,w as f,v as D,t as l,n as c,e as v,r as C,o as d}from"./index-DkYQcLuh.js";const I={name:"Search",components:{QrcodeImage:m,VueQrcode:p},data(){return{hasData:null,hasQr:!1,code:null,error:null,serchData:null,data:null,isfetching:!1}},methods:{onDataUrlChange(s){this.dataUrl=s},fetchData(){fetch(`https://script.google.com/macros/s/AKfycbyGzrVU7RTZXkpX0tuTvGhtVBNI3r7uBTEA5lVgzCOIbhf1APs7tnqYAfIuncjWNkMZ0g/exec?option=test1&searchData=${this.serchData}`).then(s=>s.json()).then(s=>{this.isfetching=!1,s.status===200?(this.hasData=!0,this.hasQr=s.message[5]==="PAID",this.code=s.message[6],this.data=s.message):this.error="No data found."}).catch(s=>{this.isfetching=!1,this.error="An error occurred while fetching data."})},getData(){this.serchData?(this.isfetching=!0,this.hasData=!1,this.error=null,this.data=null,this.fetchData()):this.error="Please enter a valid NIC, contact number or QR code."},toPaid(){fetch(`https://script.google.com/macros/s/AKfycbzc8HNokNvScYHh9dJTzScE-IXKhNq-eEtDSzE9M-FOzm204wUMK46Dwib33pp7EhqB/exec?option=paidSuccess&searchData=${this.data[0]}`).then(s=>s.json()).then(s=>{s.status===200?(this.isfetching=!0,this.hasData=!1,this.error=null,this.data=null,this.fetchData()):this.error="An error occurred while updating data."}).catch(s=>{this.error="An error occurred while updating data.",console.error(s)})},toUnPaid(){fetch(`https://script.google.com/macros/s/AKfycbzc8HNokNvScYHh9dJTzScE-IXKhNq-eEtDSzE9M-FOzm204wUMK46Dwib33pp7EhqB/exec?option=paidUnSuccess&searchData=${this.data[0]}`).then(s=>s.json()).then(s=>{s.status===200?(this.isfetching=!0,this.hasData=!1,this.error=null,this.data=null,this.fetchData()):this.error="An error occurred while updating data."}).catch(s=>{this.error="An error occurred while updating data.",console.error(s)})},downloadQr(){let t=document.getElementById("qrcodeImage").src,n=document.createElement("a");n.href=t,n.download=`BTDT_HOLI_${this.code}.png`,n.click()},shareQr(){let t=document.getElementById("qrcodeImage").src;navigator.share?navigator.share({title:"BTDT Holi QR Code",text:"BTDT Holi QR Code",url:t}).then(()=>console.log("Successful share")).catch(n=>console.log("Error sharing",n)):console.log("Web Share API not supported.")}}},b={class:"search"},q={class:"search-bar"},k={class:""},N={key:0,class:"loading"},Q={key:1,class:"info"},S={class:"card"},w={class:"item"},A={class:"item"},E={class:"item"},y={class:"item"},B={class:"item"},P={class:"item"},T={class:"item"},U={class:"action"},_={key:2,class:"qr"};function z(s,t,n,x,r,o){const u=C("vue-qrcode");return d(),i("div",b,[e("div",q,[t[6]||(t[6]=e("p",null,"Enter NIC, contact number or QR code to get the information.",-1)),e("div",k,[f(e("input",{type:"text",placeholder:"Search","onUpdate:modelValue":t[0]||(t[0]=a=>r.serchData=a),required:""},null,512),[[D,r.serchData]]),e("button",{onClick:t[1]||(t[1]=(...a)=>o.getData&&o.getData(...a))},"Search")])]),e("p",null,l(r.error),1),r.isfetching?(d(),i("div",N,t[7]||(t[7]=[e("span",null,null,-1),e("span",null,null,-1),e("span",null,null,-1),e("span",null,null,-1),e("span",null,null,-1)]))):h("",!0),r.hasData?(d(),i("div",Q,[t[15]||(t[15]=e("h2",null,"Information",-1)),e("div",S,[e("div",w,[t[8]||(t[8]=e("p",null,"ID:",-1)),e("p",null,l(r.data[0]),1)]),e("div",A,[t[9]||(t[9]=e("p",null,"Name:",-1)),e("p",null,l(r.data[1]),1)]),e("div",E,[t[10]||(t[10]=e("p",null,"NIC Number:",-1)),e("p",null,l(r.data[2]),1)]),e("div",y,[t[11]||(t[11]=e("p",null,"Batch:",-1)),e("p",null,l(r.data[3]),1)]),e("div",B,[t[12]||(t[12]=e("p",null,"Contact:",-1)),e("p",null,l(r.data[4]),1)]),e("div",P,[t[13]||(t[13]=e("p",null,"Status:",-1)),e("p",null,l(r.data[5]),1)]),e("div",T,[t[14]||(t[14]=e("p",null,"QR Code:",-1)),e("p",null,l(r.data[6]),1)])]),e("div",U,[e("button",{onClick:t[2]||(t[2]=(...a)=>o.toPaid&&o.toPaid(...a)),class:c(r.data[5]==="PAID"?"disabled":"")}," Paid ",2),e("button",{onClick:t[3]||(t[3]=(...a)=>o.toUnPaid&&o.toUnPaid(...a)),class:c(r.data[5]==="PAID"?"":"disabled")}," Unpaid ",2)])])):h("",!0),r.hasQr?(d(),i("div",_,[t[16]||(t[16]=e("h2",null,"QR Code",-1)),v(u,{id:"qrcodeImage",style:{margin:"0",padding:"0"},class:"img",tag:"svg",value:r.code,options:{version:30,errorCorrectionLevel:"H",type:"image/png",color:{dark:"#000",light:"#fff"}},onChange:o.onDataUrlChange},null,8,["value","onChange"]),e("div",null,[e("button",{onClick:t[4]||(t[4]=(...a)=>o.downloadQr&&o.downloadQr(...a))},"Download"),e("button",{onClick:t[5]||(t[5]=(...a)=>o.shareQr&&o.shareQr(...a))},"Share")])])):h("",!0)])}const V=g(I,[["render",z],["__scopeId","data-v-5d58fa55"]]);export{V as default};
